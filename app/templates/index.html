{% extends "base.html" %}

{% block content %}
<section class="hero">
  <div class="hero-slider{% if not home_images %} hero-placeholder{% endif %}" data-images='{{ home_images | tojson }}'>
    <div class="hero-overlay">
      <h1>Asociación Cielos Despejados</h1>
      {% if not home_images %}
      <p class="hero-helper">Añade imágenes en <strong>/static/pics/home/</strong> para activar la galería.</p>
      {% endif %}
    </div>
  </div>
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Próximas actividades</h2>
    <p>
      Consulta las próximas observaciones, talleres y encuentros de la asociación.
    </p>
  </div>
  {% if upcoming_activities %}
  <div class="cards cards--three">
    {% for activity in upcoming_activities %}
    <article class="card">
      {% if activity.image_url %}
      <img src="{{ activity.image_url }}" alt="{{ activity.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ activity.title }}</h3>
        {% if user and activity.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        {% if activity.celebration_at_display %}
        <p class="card-meta">{{ activity.celebration_at_display }}</p>
        {% endif %}
        <p>{{ activity.summary }}</p>
        <a class="button ghost" href="/actividades/{{ activity._id }}">Ver más</a>
      </div>
    </article>
    {% endfor %}
  </div>
  {% else %}
  <p class="muted">
    No hay actividades previstas. Publicaremos las próximas actividades en la web y en nuestras redes sociales.
  </p>
  {% endif %}
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Últimas actividades</h2>
    <p>
      Revive nuestras últimas actividades y encuentros de la asociación.
    </p>
  </div>
  <div class="cards cards--three">
    {% for activity in recent_activities %}
    <article class="card">
      {% if activity.image_url %}
      <img src="{{ activity.image_url }}" alt="{{ activity.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ activity.title }}</h3>
        {% if user and activity.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        {% if activity.celebration_at_display %}
        <p class="card-meta">{{ activity.celebration_at_display }}</p>
        {% endif %}
        <p>{{ activity.summary }}</p>
        <a class="button ghost" href="/actividades/{{ activity._id }}">Ver más</a>
      </div>
    </article>
    {% else %}
    {% for _ in range(3) %}
    <article class="card placeholder-card">
      <div class="placeholder-thumb"></div>
      <div class="card-content">
        <h3>Actividad en preparación</h3>
        <p>Muy pronto compartiremos salidas, talleres y nuevas observaciones.</p>
      </div>
    </article>
    {% endfor %}
    {% endfor %}
  </div>
  <a class="button" href="/actividades">Ver todas las actividades</a>
</section>

<section class="section container reveal">
  <div class="section-grid">
    <div class="section-text">
      <h2>Conócenos</h2>
      <p>
        Somos un grupo de aficionados a la astronomía con sede en Oviedo, Asturias. Nos reunimos habitualmente en el
        Hotel de Asociaciones Santullano los últimos viernes de cada mes a las 19.00. Si quieres conocernos, estaremos
        encantados de recibirte. Contáctanos por redes sociales o a través de
        <a href="/contacto">este formulario</a> para más información y para confirmar nuestras próximas reuniones.
      </p>
    </div>
    <div class="section-media">
      <img src="/static/store/page/CDnosotros.png" alt="Miembros de la asociación" />
    </div>
  </div>
</section>

<section class="section container reveal">
  <div class="section-grid">
    <div class="section-media">
      <div class="mini-slider" data-images='{{ photos | map(attribute="image_url") | list | tojson }}'>
        {% if photos %}
        <img src="{{ photos[0].image_url }}" alt="Astrofoto" />
        {% else %}
        <div class="placeholder">Próximamente nuevas astrofotos</div>
        {% endif %}
      </div>
    </div>
    <div class="section-text">
      <h2>Astrofotografía</h2>
      <p>
        Una selección de las últimas imágenes capturadas por nuestros socios, desde nebulosas
        hasta galaxias lejanas. Cada fotografía es fruto de noches de observación y pasión por el cielo.
      </p>
      <a class="button" href="/astrofotos">Ver más</a>
    </div>
  </div>
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Nuestro blog</h2>
    <p>
      Descubre nuestras actividades, talleres y salidas astronómicas en el blog de la asociación.
    </p>
  </div>
  <div class="cards">
    {% for entry in blog_entries %}
    <article class="card">
      {% if entry.image_url %}
      <img src="{{ entry.image_url }}" alt="{{ entry.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ entry.title }}</h3>
        {% if user and entry.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        <p>{{ entry.summary }}</p>
        <a class="button ghost" href="/blog/{{ entry._id }}">Ver más</a>
      </div>
    </article>
    {% else %}
    {% for _ in range(3) %}
    <article class="card placeholder-card">
      <div class="placeholder-thumb"></div>
      <div class="card-content">
        <h3>Próxima publicación</h3>
        <p>Muy pronto compartiremos noticias, talleres y salidas.</p>
      </div>
    </article>
    {% endfor %}
    {% endfor %}
  </div>
  <a class="button" href="/blog">Ver todas las entradas</a>
</section>
{% endblock %}
