{% extends "base.html" %}

{% block content %}
<section class="hero">
  <div class="hero-slider{% if not home_images %} hero-placeholder{% endif %}" data-images='{{ home_images | tojson }}'>
    <div class="hero-overlay">
      <h1>Asociación Cielos Despejados</h1>
      {% if not home_images %}
      <p class="hero-helper">Añade imágenes en <strong>/static/pics/home/</strong> para activar la galería.</p>
      {% endif %}
    </div>
  </div>
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Próximas actividades</h2>
    <p>
      Consulta las próximas observaciones, talleres y encuentros de la asociación.
    </p>
  </div>
  {% if upcoming_activities %}
  <div class="cards cards--three">
    {% for activity in upcoming_activities %}
    <article class="card">
      {% if activity.image_url %}
      <img src="{{ activity.image_url }}" alt="{{ activity.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ activity.title }}</h3>
        {% if user and activity.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        {% if activity.celebration_at_display %}
        <p class="card-meta">{{ activity.celebration_at_display }}</p>
        {% endif %}
        <p>{{ activity.summary }}</p>
        <a class="button ghost" href="/actividades/{{ activity._id }}">Ver más</a>
      </div>
    </article>
    {% endfor %}
  </div>
  {% else %}
  <div class="upcoming-empty">
    <div class="upcoming-empty__image">
      <img src="/static/store/page/CDactividades.png" alt="Actividades de la asociación" />
    </div>
    <div class="upcoming-empty__content">
      <p class="muted">
        No hay actividades previstas. Publicaremos las próximas actividades en la web y en nuestras redes sociales.
      </p>
      <div class="upcoming-empty__socials">
        <a class="social-link" href="https://www.facebook.com/cielosdespejados/" target="_blank" rel="noopener" aria-label="Facebook">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M13.5 8.5V7c0-.9.6-1.1 1-1.1h2V3h-2.5C11.9 3 10 4.8 10 6.9v1.6H8v3h2v9h3.5v-9h2.4l.4-3h-2.8z"/>
          </svg>
        </a>
        <a class="social-link" href="https://www.instagram.com/cielosdespejadosasturias/" target="_blank" rel="noopener" aria-label="Instagram">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M7.5 3h9A4.5 4.5 0 0 1 21 7.5v9A4.5 4.5 0 0 1 16.5 21h-9A4.5 4.5 0 0 1 3 16.5v-9A4.5 4.5 0 0 1 7.5 3zm0 2A2.5 2.5 0 0 0 5 7.5v9A2.5 2.5 0 0 0 7.5 19h9a2.5 2.5 0 0 0 2.5-2.5v-9A2.5 2.5 0 0 0 16.5 5h-9z"/>
            <path d="M12 7.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 0 1 12 7.5zm0 2A2.5 2.5 0 1 0 14.5 12 2.5 2.5 0 0 0 12 9.5zm5.25-3.1a1 1 0 1 1-1 1 1 1 0 0 1 1-1z"/>
          </svg>
        </a>
        <a class="social-link" href="https://x.com/CielosDspejados" target="_blank" rel="noopener" aria-label="X">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18.9 3h3.1l-6.8 7.8 8 10.2h-6.6l-5.1-6.6L5.6 21H2.5l7.3-8.4L2 3h6.8l4.7 6.1L18.9 3zm-1.2 15.1h1.7L8.2 4.8H6.4l11.3 13.3z"/>
          </svg>
        </a>
      </div>
    </div>
  </div>
  {% endif %}
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Últimas actividades</h2>
    <p>
      Revive nuestras últimas actividades y encuentros de la asociación.
    </p>
  </div>
  <div class="cards cards--three">
    {% for activity in recent_activities %}
    <article class="card">
      {% if activity.image_url %}
      <img src="{{ activity.image_url }}" alt="{{ activity.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ activity.title }}</h3>
        {% if user and activity.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        {% if activity.celebration_at_display %}
        <p class="card-meta">{{ activity.celebration_at_display }}</p>
        {% endif %}
        <p>{{ activity.summary }}</p>
        <a class="button ghost" href="/actividades/{{ activity._id }}">Ver más</a>
      </div>
    </article>
    {% else %}
    {% for _ in range(3) %}
    <article class="card placeholder-card">
      <div class="placeholder-thumb"></div>
      <div class="card-content">
        <h3>Actividad en preparación</h3>
        <p>Muy pronto compartiremos salidas, talleres y nuevas observaciones.</p>
      </div>
    </article>
    {% endfor %}
    {% endfor %}
  </div>
  <a class="button" href="/actividades">Ver todas las actividades</a>
</section>

<section class="section container reveal">
  <div class="section-grid">
    <div class="section-text">
      <h2>Conócenos</h2>
      <p>
        Somos un grupo de aficionados a la astronomía con sede en Oviedo, Asturias. Nos reunimos habitualmente en el
        Hotel de Asociaciones Santullano los últimos viernes de cada mes a las 19.00. Si quieres conocernos, estaremos
        encantados de recibirte. Contáctanos por redes sociales o a través de
        <a class="text-link" href="/contacto">este formulario</a> para más información y para confirmar nuestras próximas reuniones.
      </p>
    </div>
    <div class="section-media">
      <img src="/static/store/page/CDnosotros.png" alt="Miembros de la asociación" />
    </div>
  </div>
</section>

<section class="section container reveal">
  <div class="section-grid">
    <div class="section-media">
      <div class="mini-slider" data-images='{{ photos | map(attribute="image_url") | list | tojson }}'>
        {% if photos %}
        <img src="{{ photos[0].image_url }}" alt="Astrofoto" />
        {% else %}
        <div class="placeholder">Próximamente nuevas astrofotos</div>
        {% endif %}
      </div>
    </div>
    <div class="section-text">
      <h2>Astrofotografía</h2>
      <p>
        Una selección de las últimas imágenes capturadas por nuestros socios, desde nebulosas
        hasta galaxias lejanas. Cada fotografía es fruto de noches de observación y pasión por el cielo.
      </p>
      <a class="button" href="/astrofotos">Ver más</a>
    </div>
  </div>
</section>

<section class="section section-bleed reveal">
  <a class="hero-cta" href="/asociate">
    <div class="hero-cta__content">
      <h2>Únete a Cielos Despejados</h2>
      <p>¿Eres un apasionado de la astronomía? ¿Te gustaría compartir esta pasión con nosotros?</p>
    </div>
  </a>
</section>

<section class="section container reveal">
  <div class="section-text">
    <h2>Nuestro blog</h2>
    <p>
      Descubre nuestras actividades, talleres y salidas astronómicas en el blog de la asociación.
    </p>
  </div>
  <div class="cards">
    {% for entry in blog_entries %}
    <article class="card">
      {% if entry.image_url %}
      <img src="{{ entry.image_url }}" alt="{{ entry.title }}" />
      {% endif %}
      <div class="card-content">
        <h3>{{ entry.title }}</h3>
        {% if user and entry.is_hidden %}
        <span class="visibility-badge">Oculto</span>
        {% endif %}
        <p>{{ entry.summary }}</p>
        <a class="button ghost" href="/blog/{{ entry._id }}">Ver más</a>
      </div>
    </article>
    {% else %}
    {% for _ in range(3) %}
    <article class="card placeholder-card">
      <div class="placeholder-thumb"></div>
      <div class="card-content">
        <h3>Próxima publicación</h3>
        <p>Muy pronto compartiremos noticias, talleres y salidas.</p>
      </div>
    </article>
    {% endfor %}
    {% endfor %}
  </div>
  <a class="button" href="/blog">Ver todas las entradas</a>
</section>
{% endblock %}
