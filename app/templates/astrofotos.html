{% extends "base.html" %}

{% block content %}
<section class="section container reveal">
  <h1>Astrofotos</h1>
  <div class="photo-grid">
    {% for photo in photos %}
    <a class="photo-card" href="/astrofotos/{{ photo._id }}">
      <img src="{{ photo.image_url }}" alt="{{ photo.name }}" />
      <div class="photo-info">
        <h3>{{ photo.name }}</h3>
        <p>{{ photo.author }}</p>
      </div>
    </a>
    {% else %}
    {% for _ in range(6) %}
    <div class="photo-card placeholder-card">
      <div class="placeholder-thumb"></div>
      <div class="photo-info">
        <h3>Astrofoto en preparación</h3>
        <p>Pronto tendremos nuevas imágenes.</p>
      </div>
    </div>
    {% endfor %}
    {% endfor %}
  </div>
</section>

{% if user %}
<section class="section container reveal">
  <div class="section-header">
    <h2>Subir nuevas imágenes</h2>
    <button class="button ghost" type="button" data-toggle="astrofoto-upload">Subir nuevas imágenes</button>
  </div>
  <div id="astrofoto-upload" class="card hidden">
    <div class="card-content">
      <p class="muted">Completa los datos y comparte tu última captura con la comunidad.</p>
      <form class="form" method="post" enctype="multipart/form-data">
        <label>Nombre
          <input type="text" name="name" required />
        </label>
        <label>Características
          <input type="text" name="characteristics" />
          <span class="muted">Tiempo de exposición, filtros...</span>
        </label>
        <label>Equipo usado
          <input type="text" name="equipment" list="equipment-options" />
        </label>
        {% if equipment_options %}
        <datalist id="equipment-options">
          {% for item in equipment_options %}
          <option value="{{ item.label }}"></option>
          {% endfor %}
        </datalist>
        {% endif %}
        <label>Descripción
          <textarea name="description" rows="3"></textarea>
        </label>
        <label>Autor
          <input type="text" name="author" value="{{ author_default }}" required />
        </label>
        <label>Archivo de imagen
          <input type="file" name="photo_file" accept="image/*" required />
        </label>
        <div class="astrofoto-versions" data-astrofoto-versions-form>
          <div class="section-header">
            <h3>Otras versiones</h3>
            <button class="button ghost small" type="button" data-astrofoto-add-version>Agregar versión</button>
          </div>
          <p class="muted">Puedes añadir versiones alternativas con su propia descripción.</p>
          <div class="astrofoto-versions__list" data-astrofoto-versions-list></div>
        </div>
        <button class="button" type="submit">Subir foto</button>
      </form>
    </div>
  </div>
</section>
{% endif %}
{% endblock %}
