{% extends "base.html" %}

{% block content %}
<section class="section container reveal">
  <h1>Mi perfil</h1>
  <p class="muted">Aquí puedes actualizar tus datos y gestionar tu equipo habitual.</p>
  <div class="profile-grid">
    <div class="card">
      <div class="card-content">
        <h2>Datos de usuario</h2>
        <form class="form" method="post" action="/perfil">
          <label>Nombre
            <input type="text" name="full_name" value="{{ profile.full_name }}" />
          </label>
          <label>Ubicación
            <input type="text" name="location" value="{{ profile.location }}" />
          </label>
          <label>Descripción
            <textarea name="bio" rows="3">{{ profile.bio }}</textarea>
          </label>
          <button class="button" type="submit">Guardar cambios</button>
        </form>
      </div>
    </div>

    <div class="card">
      <div class="card-content">
        <h2>Equipo de observación</h2>
        <p class="muted">
          Añade tu equipo habitual de observación o astrofotografía con las características.
        </p>
        <form class="form" method="post" action="/perfil/equipos">
          <label>Equipo de observación
            <textarea name="equipment_notes" rows="5" maxlength="500" placeholder="Telescopio, cámara, montura...">{{ profile.equipment_notes }}</textarea>
            <span class="muted">Máximo 500 caracteres.</span>
          </label>
          <button class="button" type="submit">Guardar equipo</button>
        </form>
      </div>
    </div>
  </div>

  <div class="profile-gallery">
    <div class="section-header">
      <h2>Mis entradas del blog</h2>
    </div>
    {% if blog_entries %}
    <div class="profile-entry-list">
      {% for entry in blog_entries %}
      <article class="profile-entry">
        <div class="entry-header">
          <h3>{{ entry.title }}</h3>
          {% if entry.is_hidden %}
          <span class="visibility-badge">Oculto</span>
          {% endif %}
          <a class="button ghost small" href="/blog/{{ entry._id }}/editar">Editar</a>
        </div>
        <p class="muted">{{ entry.summary }}</p>
      </article>
      {% endfor %}
    </div>
    {% else %}
    <p class="muted">Aún no has publicado entradas en el blog.</p>
    {% endif %}
  </div>

  <div class="profile-gallery">
    <div class="section-header">
      <h2>Mis actividades</h2>
    </div>
    {% if activity_entries %}
    <div class="profile-entry-list">
      {% for entry in activity_entries %}
      <article class="profile-entry">
        <div class="entry-header">
          <h3>{{ entry.title }}</h3>
          {% if entry.is_hidden %}
          <span class="visibility-badge">Oculto</span>
          {% endif %}
          <a class="button ghost small" href="/actividades/{{ entry._id }}/editar">Editar</a>
        </div>
        <p class="muted">{{ entry.summary }}</p>
      </article>
      {% endfor %}
    </div>
    {% else %}
    <p class="muted">Aún no has publicado actividades.</p>
    {% endif %}
  </div>

  <div class="profile-gallery">
    <div class="section-header">
      <h2>Mis astrofotos</h2>
    </div>
    {% if user_photos %}
    <div class="photo-grid photo-grid--compact">
      {% for photo in user_photos %}
      <a class="photo-card photo-card--compact" href="/astrofotos/{{ photo._id }}">
        <img src="{{ photo.image_url }}" alt="{{ photo.name }}" />
        <div class="photo-info">
          <h3>{{ photo.name }}</h3>
        </div>
      </a>
      {% endfor %}
    </div>
    {% else %}
    <p class="muted">Aún no has subido astrofotos.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
