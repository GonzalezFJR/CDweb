{% extends "base.html" %}

{% block content %}
<section class="section container reveal">
  <div class="astrofoto-detail">
    <h1>{{ photo.name }}</h1>
    <img src="{{ photo.image_url }}" alt="{{ photo.name }}" data-astrofoto-main />
    <div class="photo-meta">
      <ul>
        <li><strong>Autor:</strong> {{ photo.author }}</li>
        {% if photo.uploaded_by %}
        <li><strong>Subida por:</strong> {{ photo.uploaded_by }}</li>
        {% endif %}
        <li><strong>Fecha de publicación:</strong> {{ photo.uploaded_at_display }}</li>
        {% if photo.characteristics or photo.exposure_time %}
        <li><strong>Características:</strong> {{ photo.characteristics or photo.exposure_time }}</li>
        {% endif %}
        {% if photo.equipment %}
        <li><strong>Equipo:</strong> {{ photo.equipment }}</li>
        {% endif %}
      </ul>
      <p data-astrofoto-description>{{ photo.description }}</p>
      <a class="button ghost" href="{{ photo.image_url }}" target="_blank">Ver en tamaño completo</a>
    </div>
  </div>
</section>
{% if photo.versions %}
<section class="section container reveal">
  <div class="section-header">
    <h2>Otras versiones</h2>
  </div>
  <div class="astrofoto-versions-grid" data-astrofoto-versions>
    <div class="astrofoto-version-card" data-astrofoto-version data-image-url="{{ photo.image_url }}" data-description="{{ photo.description | default('', true) }}">
      <div class="astrofoto-version-card__image">
        <img src="{{ photo.image_url }}" alt="{{ photo.name }} - original" />
        <a class="astrofoto-version-card__open" href="{{ photo.image_url }}" target="_blank" rel="noopener" aria-label="Abrir imagen en nueva pestaña">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42 9.3-9.29H14V3z"></path>
            <path d="M5 5h6v2H7v10h10v-4h2v6H5V5z"></path>
          </svg>
        </a>
      </div>
      <div class="astrofoto-version-card__meta">
        <p>Imagen original</p>
        {% if photo.description %}
        <p class="astrofoto-version-card__excerpt">{{ photo.description }}</p>
        {% endif %}
      </div>
    </div>
    {% for version in photo.versions %}
    <div class="astrofoto-version-card" data-astrofoto-version data-image-url="{{ version.image_url }}" data-description="{{ version.description | default('', true) }}">
      <div class="astrofoto-version-card__image">
        <img src="{{ version.image_url }}" alt="{{ photo.name }} - versión" />
        <a class="astrofoto-version-card__open" href="{{ version.image_url }}" target="_blank" rel="noopener" aria-label="Abrir imagen en nueva pestaña">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42 9.3-9.29H14V3z"></path>
            <path d="M5 5h6v2H7v10h10v-4h2v6H5V5z"></path>
          </svg>
        </a>
      </div>
      <div class="astrofoto-version-card__meta">
        {% if version.description %}
        <p class="astrofoto-version-card__excerpt">{{ version.description }}</p>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}
<section class="section container reveal">
  <a class="button" href="/astrofotos">Volver a la galería de astrofotografías</a>
</section>
{% endblock %}
